/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/tus-js-client@1.8.0/lib/node/request.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import*as http from"http";import*as https from"https";import{parse,resolve}from"url";import{Readable,Transform}from"stream";import throttle from"lodash.throttle";function noop(){}class Request{constructor(){this._method="",this._url="",this._headers={},this._resHeaders={},this._request=null,this._aborted=!1,this.status=0,this.onerror=noop,this.onload=noop,this.upload={},this.upload.onprogress=noop,this.withCredentials=!1,this.responseText=""}open(t,e){this._method=t,this._url=e}setRequestHeader(t,e){this._headers[t]=e}send(t){let e=parse(this._url);e.method=this._method,e.headers=this._headers,t&&t.size&&(e.headers["Content-Length"]=t.size);let s=this._request="https:"!==e.protocol?http.request(e):https.request(e);s.on("response",t=>{if(this._aborted)return;this.status=t.statusCode,this._resHeaders=t.headers;const e=[];t.on("data",t=>{e.push(t)}),t.on("end",()=>{this.responseText=Buffer.concat(e).toString("utf8"),this.onload()})}),s.on("error",t=>{this._aborted||this.onerror(t)}),t instanceof Readable?t.pipe(new ProgressEmitter(this.upload.onprogress)).pipe(s):s.end(t)}getResponseHeader(t){return this._resHeaders[t.toLowerCase()]}abort(){this._aborted=!0,null!==this._request&&this._request.abort()}}class ProgressEmitter extends Transform{constructor(t){super(),this._onprogress=throttle(t,100,{leading:!0,trailing:!1}),this._position=0}_transform(t,e,s){this._position+=t.length,this._onprogress({lengthComputable:!0,loaded:this._position}),s(null,t)}}export function newRequest(){return new Request}export function resolveUrl(t,e){return resolve(t,e)}
//# sourceMappingURL=/sm/9757780db04d5868434898ebfb6d5693b04ca76ebe059bbc5067a0c2b7f8f3fe.map