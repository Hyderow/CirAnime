/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/tus-js-client@1.8.0/demos/browser/video.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";var stopRecording=null,upload=null,recordBtn=document.querySelector("#record-btn"),alertBox=document.querySelector("#support-alert"),progressBox=document.querySelector("#progress-note"),uploadList=document.querySelector("#upload-list"),chunkInput=document.querySelector("#chunksize"),endpointInput=document.querySelector("#endpoint");if(tus.isSupported||alertBox.classList.remove("hidden"),!recordBtn)throw new Error("Record button not found on this page. Aborting upload-demo.");function startUpload(e){var t=endpointInput.value,o=parseInt(chunkInput.value,10);isNaN(o)&&(o=1/0);var r={resume:!1,endpoint:t,chunkSize:o,retryDelays:[0,1e3,3e3,5e3],uploadLengthDeferred:!0,metadata:{filename:"webcam.webm",filetype:"video/webm"},onError:function(e){if(e.originalRequest){if(window.confirm("Failed because: "+e+"\nDo you want to retry?"))return void upload.start()}else window.alert("Failed because: "+e);reset()},onProgress:function(e){progressBox.textContent="Uploaded "+e+" bytes so far."},onSuccess:function(){var e=document.createElement("li"),t=document.createElement("video");t.controls=!0,t.src=upload.url,e.appendChild(t);var o=document.createElement("br");e.appendChild(o);var n=document.createElement("a");n.textContent="Download "+r.metadata.filename,n.href=upload.url,n.className="btn btn-success",e.appendChild(n),uploadList.appendChild(e),reset()}};(upload=new tus.Upload(e,r)).start()}function startStreamUpload(){navigator.mediaDevices.getUserMedia({video:!0}).then(e=>{const t=new MediaRecorder(e),o=[];let r=!1,n=null;t.onerror=onError,t.onstop=(()=>{r=!0,n&&n(a.read())}),t.ondataavailable=(e=>{o.push(e.data),n&&(n(a.read()),n=void 0)}),t.start(1e3);const a={read:()=>r&&0===o.length?Promise.resolve({done:!0}):o.length>0?Promise.resolve({value:o.shift(),done:!1}):new Promise(e=>{n=e})};startUpload(a),stopRecording=(()=>{e.getTracks().forEach(e=>e.stop()),t.stop(),stopRecording=null})}).catch(onError)}function reset(){upload=null}function onError(e){console.log(e),alert("An error occurred: "+e),upload=null,stopRecording=null,recordBtn.textContent="Start Recording"}recordBtn.addEventListener("click",function(e){e.preventDefault(),stopRecording?(recordBtn.textContent="Start Recording",stopRecording()):(recordBtn.textContent="Stop Recording",startStreamUpload())});
//# sourceMappingURL=/sm/aead3ecdf709fcd105d4880b2a18b56aac3153bea1b99cd79dfb81c273957a01.map